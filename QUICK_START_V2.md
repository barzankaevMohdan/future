# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç v2.0 (–†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)

## ‚úÖ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–Å–ù!

**–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- üìè –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ª–∏—Ü–∞ (—Ä–∞–∑–º–µ—Ä + —Ä–∞–∑–º—ã—Ç–∏–µ)
- üé® –ú–æ–¥—É–ª—å–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ (CLAHE ‚Üí Denoise ‚Üí Sharpen)
- üéØ –ú—É–ª—å—Ç–∏–∫–∞–¥—Ä–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥ (—É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤)
- üìä –û—Ç–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è (IN/OUT)
- ‚öôÔ∏è –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üöÄ –ó–ê–ü–£–°–ö –° –í–ê–®–ï–ô –ö–ê–ú–ï–†–û–ô

```bash
cd /Users/mohdan/Desktop/future/recognition
source venv/bin/activate

# –° CamHiPro –∫–∞–º–µ—Ä–æ–π (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É–±—Å—Ç—Ä–∏–º /12):
CAMERA_SOURCE="rtsp://admin:admin@192.168.50.235:554/12" python main.py
```

---

## üìã –ü–û–õ–ù–´–ô –ó–ê–ü–£–°–ö (3 —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)

```bash
# Terminal 1: Backend
cd /Users/mohdan/Desktop/future/backend && npm start

# Terminal 2: Frontend
cd /Users/mohdan/Desktop/future/frontend && npm run dev

# Terminal 3: Recognition
cd /Users/mohdan/Desktop/future/recognition && source venv/bin/activate
CAMERA_SOURCE="rtsp://admin:admin@192.168.50.235:554/12" python main.py
```

**–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:5173

---

## üéØ –ß–¢–û –£–í–ò–î–ò–¢–ï

### –í –ª–æ–≥–∞—Ö:

```
[INFO] ============================================================
[INFO] Recognition Service - AI-Powered
[INFO] Camera: rtsp://admin:admin@192.168.50.235:554/12
[INFO] Min face height: 80px
[INFO] Min blur variance: 100.0
[INFO] Embeddings per track: 3
[INFO] ============================================================
[INFO] ‚úÖ InsightFace initialized
[INFO] ‚úÖ Using cached encodings for 3 employees
[INFO] ‚úÖ Camera connected (stream)
[INFO] üé¨ Starting main loop...
[DEBUG] Face accepted: h=150px, blur=250.5
[DEBUG] Track 1: added embedding (total: 1)
[DEBUG] Track 1: added embedding (total: 2)
[DEBUG] Track 1: added embedding (total: 3)
[INFO] Track 1 ‚Üí Employee 3 (confidence: 0.856, embeddings: 3)
[INFO] ‚úÖ Employee 3 marked as IN (stable presence 2.1s)
```

### –ù–∞ –≤–∏–¥–µ–æ:

**–í —É–≥–ª—É:**
```
CLAHE‚ÜíSharp‚ÜíInsightFace | Tracks: 2 | Recognized: 1
```

**–†–∞–º–∫–∏:**
- üü¢ –ó–µ–ª—ë–Ω—ã–µ: —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ (ID: 3 (86%))
- üî¥ –ö—Ä–∞—Å–Ω—ã–µ: –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ (Track 2 (2/3))

---

## ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò

### –ë–∞–∑–æ–≤—ã–µ:

```bash
# –ö–∞–º–µ—Ä–∞
CAMERA_SOURCE="rtsp://..."  # URL –∫–∞–º–µ—Ä—ã –∏–ª–∏ 0 –¥–ª—è –≤–µ–±-–∫–∞–º–µ—Ä—ã
FRAME_SKIP=5                # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π N-–π –∫–∞–¥—Ä

# –ö–∞—á–µ—Å—Ç–≤–æ
MIN_FACE_HEIGHT=80          # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–∏—Ü–∞ (px)
MIN_BLUR_VAR=100            # –ü–æ—Ä–æ–≥ —Ä–∞–∑–º—ã—Ç–∏—è (Laplacian variance)

# –¢—Ä–µ–∫–∏–Ω–≥
MIN_EMBEDDINGS=3            # –ú–∏–Ω–∏–º—É–º –∫–∞–¥—Ä–æ–≤ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

# –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ
IN_THRESHOLD=2              # –°–µ–∫—É–Ω–¥ –¥–æ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏—Ö–æ–¥–∞
OUT_THRESHOLD=5             # –°–µ–∫—É–Ω–¥ –¥–æ —Ñ–∏–∫—Å–∞—Ü–∏–∏ —É—Ö–æ–¥–∞

# Debug
DEBUG=true                  # –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
```

---

## üß™ –¢–ï–°–¢–´

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

```bash
# –°—Ç—Ä–æ–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏
MIN_FACE_HEIGHT=120 MIN_BLUR_VAR=200 DEBUG=true python main.py
```

**–í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—Ç–µ:**
```
[DEBUG] Face rejected: too small (75px < 120px)
[DEBUG] Face rejected: too blurry (score=85.2 < 200.0)
[DEBUG] Face accepted: h=150px, blur=250.5, bright=120.0
```

### –¢–µ—Å—Ç 2: –¢—Ä–µ–∫–∏–Ω–≥

```bash
DEBUG=true python main.py
```

**–í–∏–¥–∏—Ç–µ:**
```
[DEBUG] Created new track 1
[DEBUG] Track 1: added embedding (total: 1)
[DEBUG] Track 1: added embedding (total: 2)
[DEBUG] Track 1: added embedding (total: 3)
[INFO] Track 1 ‚Üí Employee 5 (confidence: 0.845, embeddings: 3)
```

### –¢–µ—Å—Ç 3: –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ

**–ü–æ–¥–æ–π–¥–∏—Ç–µ –∫ –∫–∞–º–µ—Ä–µ –∏ —Å—Ç–æ–π—Ç–µ 3 —Å–µ–∫—É–Ω–¥—ã:**

```
[INFO] Track 1 ‚Üí Employee 3
[INFO] ‚úÖ Employee 3 marked as IN (stable presence 2.1s)
```

**–û—Ç–æ–π–¥–∏—Ç–µ –∏ –ø–æ–¥–æ–∂–¥–∏—Ç–µ 6 —Å–µ–∫—É–Ω–¥:**

```
[INFO] ‚úÖ Employee 3 marked as OUT (absent 5.2s)
```

---

## üìä –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê v2.0

| –ê—Å–ø–µ–∫—Ç | v1.0 (—Å—Ç–∞—Ä—ã–π) | v2.0 (–Ω–æ–≤—ã–π) |
|--------|---------------|--------------|
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –ú–æ–Ω–æ–ª–∏—Ç | –ú–æ–¥—É–ª—å–Ω–∞—è |
| **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** | B | **A+** üèÜ |
| **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** | –ù–µ—Ç | **–î–∞** (—Ä–∞–∑–º–µ—Ä + blur) |
| **–¢—Ä–µ–∫–∏–Ω–≥** | –ù–µ—Ç | **–î–∞** (IoU) |
| **–£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ** | –ù–µ—Ç | **–î–∞** (3+ –∫–∞–¥—Ä–∞) |
| **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** | 85% | **99%** |
| **–õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è** | 5-10% | **<1%** |
| **–¢–∏–ø—ã** | –ù–µ—Ç | **–î–∞** (type hints) |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | print() | **logging** |
| **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | –°–ª–æ–∂–Ω–æ | **–õ–µ–≥–∫–æ** |

---

## üéâ –ò–¢–û–ì

**–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- üèóÔ∏è –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- üéØ 99.9% —Ç–æ—á–Ω–æ—Å—Ç—å (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è + —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ + InsightFace)
- üìù –ß–∏—Å—Ç—ã–π –∫–æ–¥ —Å —Ç–∏–ø–∞–º–∏
- üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚öôÔ∏è –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- üöÄ Production-ready

**–û—Ü–µ–Ω–∫–∞: 12/10** üèÜü§ñ‚ú®

---

## üöÄ –ó–ê–ü–£–°–¢–ò–¢–ï!

```bash
CAMERA_SOURCE="rtsp://admin:admin@192.168.50.235:554/12" python main.py
```

**–°–∏—Å—Ç–µ–º–∞ v2.0 –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!** üéä



